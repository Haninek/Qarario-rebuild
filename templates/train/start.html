
{% extends "base.html" %}
{% block title %}Start Training - Qarari{% endblock %}
{% block page_title %}Start Model Training{% endblock %}
{% block page_description %}Begin training new risk assessment models{% endblock %}

{% block content %}
<div class="row g-4">
    <!-- Quick Start Training -->
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-rocket me-2"></i>Quick Start Training</h5>
            </div>
            <div class="card-body">
                <form id="quickTrainingForm">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Training Dataset</label>
                            <select class="form-select" id="trainingDataset">
                                <option value="risk_assessment_2024">Risk Assessment Dataset 2024 (15K samples)</option>
                                <option value="credit_scoring_2024">Credit Scoring Dataset 2024 (12K samples)</option>
                                <option value="business_loans_2023">Business Loans Dataset 2023 (8K samples)</option>
                                <option value="default_prediction_2024">Default Prediction Dataset 2024 (20K samples)</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Model Algorithm</label>
                            <select class="form-select" id="algorithm">
                                <option value="auto">Auto-Select Best Algorithm</option>
                                <option value="random_forest">Random Forest</option>
                                <option value="gradient_boost">Gradient Boosting</option>
                                <option value="neural_network">Neural Network</option>
                                <option value="ensemble">Ensemble Model</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row g-3 mt-3">
                        <div class="col-md-4">
                            <label class="form-label">Training Mode</label>
                            <select class="form-select" id="trainingMode">
                                <option value="standard">Standard Training</option>
                                <option value="fast">Fast Training (Reduced Accuracy)</option>
                                <option value="thorough">Thorough Training (Best Results)</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Validation Split</label>
                            <select class="form-select" id="validationSplit">
                                <option value="0.2">20% Validation</option>
                                <option value="0.25">25% Validation</option>
                                <option value="0.3">30% Validation</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Max Training Time</label>
                            <select class="form-select" id="maxTime">
                                <option value="30">30 minutes</option>
                                <option value="60">1 hour</option>
                                <option value="120">2 hours</option>
                                <option value="unlimited">Unlimited</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <button type="button" class="btn btn-primary btn-lg" onclick="startQuickTraining()">
                            <i class="fas fa-play me-2"></i>Start Training
                        </button>
                        <button type="button" class="btn btn-outline-secondary btn-lg ms-2" onclick="resetForm()">
                            <i class="fas fa-redo me-2"></i>Reset
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Training Queue -->
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-list me-2"></i>Training Queue</h5>
            </div>
            <div class="card-body">
                <div id="trainingQueue">
                    <div class="alert alert-info text-center">
                        <i class="fas fa-info-circle me-2"></i>
                        No training jobs in queue
                    </div>
                </div>
                
                <div class="mt-3">
                    <h6>System Resources</h6>
                    <div class="mb-2">
                        <small class="text-muted">CPU Usage</small>
                        <div class="progress">
                            <div class="progress-bar bg-success" style="width: 25%">25%</div>
                        </div>
                    </div>
                    <div class="mb-2">
                        <small class="text-muted">Memory Usage</small>
                        <div class="progress">
                            <div class="progress-bar bg-warning" style="width: 60%">60%</div>
                        </div>
                    </div>
                    <div class="mb-2">
                        <small class="text-muted">GPU Usage</small>
                        <div class="progress">
                            <div class="progress-bar bg-info" style="width: 15%">15%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Advanced Training Options -->
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-cogs me-2"></i>Advanced Training Options</h5>
            </div>
            <div class="card-body">
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="card border">
                            <div class="card-body text-center">
                                <i class="fas fa-brain text-primary fs-1 mb-3"></i>
                                <h5>Custom Neural Network</h5>
                                <p class="text-muted">Design your own neural network architecture with custom layers and parameters.</p>
                                <button class="btn btn-outline-primary" onclick="openNeuralNetworkBuilder()">
                                    <i class="fas fa-tools me-1"></i>Build Network
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card border">
                            <div class="card-body text-center">
                                <i class="fas fa-chart-line text-success fs-1 mb-3"></i>
                                <h5>Hyperparameter Tuning</h5>
                                <p class="text-muted">Optimize model performance with automated hyperparameter search.</p>
                                <button class="btn btn-outline-success" onclick="openHyperparameterTuning()">
                                    <i class="fas fa-search me-1"></i>Tune Parameters
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card border">
                            <div class="card-body text-center">
                                <i class="fas fa-layer-group text-warning fs-1 mb-3"></i>
                                <h5>Ensemble Learning</h5>
                                <p class="text-muted">Combine multiple models to create a more robust prediction system.</p>
                                <button class="btn btn-outline-warning" onclick="openEnsembleBuilder()">
                                    <i class="fas fa-plus me-1"></i>Create Ensemble
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let trainingJobId = 0;

function startQuickTraining() {
    const dataset = document.getElementById('trainingDataset').value;
    const algorithm = document.getElementById('algorithm').value;
    const mode = document.getElementById('trainingMode').value;
    
    // Create new training job
    trainingJobId++;
    const jobName = `Training_Job_${trainingJobId}`;
    
    // Add to queue
    addToTrainingQueue(jobName, dataset, algorithm, mode);
    
    // Show success message
    alert(`Training job "${jobName}" has been added to the queue and will start shortly.`);
}

function addToTrainingQueue(jobName, dataset, algorithm, mode) {
    const queueContainer = document.getElementById('trainingQueue');
    
    // Remove "no jobs" message if it exists
    const noJobsAlert = queueContainer.querySelector('.alert-info');
    if (noJobsAlert) {
        noJobsAlert.remove();
    }
    
    // Create job card
    const jobCard = document.createElement('div');
    jobCard.className = 'card mb-2';
    jobCard.innerHTML = `
        <div class="card-body p-3">
            <div class="d-flex justify-content-between align-items-start">
                <div>
                    <h6 class="card-title mb-1">${jobName}</h6>
                    <small class="text-muted">${dataset}</small><br>
                    <small class="text-muted">${algorithm} - ${mode}</small>
                </div>
                <span class="badge bg-warning">Queued</span>
            </div>
            <div class="progress mt-2" style="height: 4px;">
                <div class="progress-bar" style="width: 0%"></div>
            </div>
        </div>
    `;
    
    queueContainer.appendChild(jobCard);
    
    // Simulate job progression
    setTimeout(() => {
        const badge = jobCard.querySelector('.badge');
        badge.className = 'badge bg-primary';
        badge.textContent = 'Running';
        
        const progressBar = jobCard.querySelector('.progress-bar');
        let progress = 0;
        const interval = setInterval(() => {
            progress += Math.random() * 10;
            if (progress > 100) progress = 100;
            progressBar.style.width = progress + '%';
            
            if (progress >= 100) {
                clearInterval(interval);
                badge.className = 'badge bg-success';
                badge.textContent = 'Completed';
            }
        }, 1000);
    }, 2000);
}

function resetForm() {
    document.getElementById('quickTrainingForm').reset();
}

function openNeuralNetworkBuilder() {
    alert('Neural Network Builder will open in a new window (feature coming soon).');
}

function openHyperparameterTuning() {
    alert('Hyperparameter Tuning interface will open (feature coming soon).');
}

function openEnsembleBuilder() {
    alert('Ensemble Model Builder will open (feature coming soon).');
}
</script>
{% endblock %}
